jQuery.sap.declare("compRT_App.Combined.Light.util.powerBiControls");compRT_App.Combined.Light.util.powerBiControls={takeScreenShot:function(){html2canvas(document.getElementById("powerBiPop--powerBiDialog-cont"),{onrendered:function(e){var t=document.createElement("canvas");t.width=450;t.height=450;var o=t.getContext("2d");o.drawImage(e,0,0,1440,638,0,0,1440,638);var r=document.createElement("a");r.href=t.toDataURL("image/jpg");r.download="screenshot.jpg";r.click()}})},embedReport:function(e,t,o,r,n,a,i){this.embedReportAndSetTokenListener(e,t,o,r,n,a,i)},fullscreen:function(){var e=$("#embedContainer")[0];var t=powerbi.get(e);t.fullscreen()},createConfig:function(e,t,o,r,n,a,i){var p=i?i:"";var c="MUWI";var d=[];if(r&&i){for(var s=0;s<r.length;s++)d.push(r[s].muwi)}var l={$schema:"http://powerbi.com/product/schema#advanced",target:{table:p,column:c},operator:"In",values:d};var m=window["powerbi-client"].models;var v=m.Permissions.All;var u="https://app.powerbi.com/reportEmbed?reportId="+t+"&groupId="+o;var h={type:"report",id:t,embedUrl:u,tokenType:m.TokenType.Embed,permissions:v,filters:[l],settings:{navContentPaneEnabled:false,customLayout:{pageSize:{type:m.PageSizeType.Custom,width:1600,height:1200}},displayOption:m.DisplayOption.ActualSize,filterPaneEnabled:false,extensions:[{command:{name:"copy",title:"copy",icon:"",extend:{visualContextMenu:{title:"Copy Key Value"}}}}]},accessToken:e};return h},embedReportAndSetTokenListener:function(e,t,o,r,n,a,i){var p=this;var c=$(n)[0];var d=e.reportId;var s=e.groupId;var l=e.accessToken;var m=this.createConfig(l,d,s,t,o,r,i);var v=powerbi.embedNew(c,m);var u=powerbi.get(c);setInterval(function(){u.refresh()},16e3);v.on("loaded",function(){var e=a.byId((n+"_VBox").replace("#","")).$()[0].offsetWidth-2;var t=a.byId((n+"_VBox").replace("#","")).$()[0].offsetHeight;var o=t-52+"px";$(n).height(o);$(n).width(e)}.bind(this))}};