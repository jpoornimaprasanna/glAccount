/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/m/ListBase","compRT_App/Combined/Light/util/Box","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ui/thirdparty/jquery"],function(e,t,i,s,o,n){"use strict";var r=e.ListGrowingDirection;var a={Phone:"sapTntBoxContainerSizeS",Tablet:"sapTntBoxContainerSizeM",Desktop:"sapTntBoxContainerSizeL",LargeDesktop:"sapTntBoxContainerSizeXL"};var p=t.extend("compRT_App.Combined.Light.util.BoxContainerList",{metadata:{properties:{boxMinWidth:{type:"sap.ui.core.CSSSize",defaultValue:""},boxWidth:{type:"sap.ui.core.CSSSize",defaultValue:""},boxesPerRowConfig:{type:"string",group:"Behavior",defaultValue:"XL7 L6 M4 S2"}}}});p.prototype.onBeforeRendering=function(){this._deregisterResizeListener();t.prototype.onBeforeRendering.apply(this,arguments)};p.prototype.exit=function(){this._deregisterResizeListener();t.prototype.exit.apply(this,arguments)};p.prototype.onAfterRendering=function(){this._registerResizeListener();if(!this._hasBoxWidth()){this._applySizeClass(this.$().width())}if(s.browser.msie){this._flattenHeight()}t.prototype.onAfterRendering.apply(this,arguments)};p.prototype._registerResizeListener=function(){this._sResizeListenerId=o.register(this,this._onResize.bind(this))};p.prototype._hasBoxWidth=function(){return this.getBoxWidth()||this.getBoxMinWidth()};p.prototype._deregisterResizeListener=function(){if(this._sResizeListenerId){o.deregister(this._sResizeListenerId);this._sResizeListenerId=null}};p.prototype._onResize=function(e){if(e){if(!this._hasBoxWidth()){this._applySizeClass(e.size.width)}this.setItemNavigationColumns()}if(s.browser.msie){this._flattenHeight()}};p.prototype._applySizeClass=function(e){var t=this.$(),i=s.media.getCurrentRange("StdExt",e),o=a[i.name],n;if(!t.hasClass(o)){n=Object.keys(a).map(function(e){return a[e]});t.removeClass(n.join(" "));t.addClass(o)}};p.prototype._flattenHeight=function(){var e=[],t=0,s;this.getItems().forEach(function(o){if(o instanceof i){s=o.getDomRef();e.push(s);s.style.height=null;t=Math.max(s.getBoundingClientRect().height,t)}});e.forEach(function(e){if(e.getBoundingClientRect().height<t){e.style.height=t+"px"}})};p.prototype._startItemNavigation=function(){t.prototype._startItemNavigation.apply(this,arguments);if(this._oItemNavigation){this._oItemNavigation.setTableMode(true,false);this.setItemNavigationColumns()}};p.prototype.setItemNavigationColumns=function(){var e,t,i,s;if(!this._oItemNavigation){return}e=this.getItems();if(e.length){t=e[0].$().offset().top;for(i=1;i<e.length;i++){s=e[i];if(s.$().offset().top!==t){break}}this._oItemNavigation.setColumns(i)}};p.prototype.setNavigationItems=function(e,t){var i=[];if(this.isGrouped()){i=n(t).find(".sapTntBoxContainerGrid > .sapMLIB").get()}else{i=n(t).children(".sapMLIB").get()}e.setItemDomRefs(i);if(e.getFocusedIndex()==-1){if(this.getGrowing()&&this.getGrowingDirection()==r.Upwards){e.setFocusedIndex(i.length-1)}else{e.setFocusedIndex(0)}}};return p});